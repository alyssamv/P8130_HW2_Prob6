---
title: "Biostat HW2 Prob 6"
author: "Alyssa Vanderbeek"
date: "28 September 2018"
output: pdf_document
---

## Problem 6

### A researcher is conducting a study to examine associations of depression and cognitive performance with migraine symptoms. Use data from the Human Epilepsy Project (HEP) to answer the following questions.

Migraine status 0-no, 1-yes
NDDIE: Neurological Disorder Depression Inventory for Epilepsy
CESD: Center for Epidemiologic Studies Depression Scale
Cognitive evaluation: Aldenkamp-Baker

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
load("~/Desktop/FALL 2018/Biostat I/Homework/Write ups/P8130_HW2_Prob6/migraine.RData")

migraine_data = migraine %>%
  janitor::clean_names() %>%  # brings colnames to lowercase, no white space
  mutate(migraine = recode(migraine, `0` = 'no', `1` = 'yes')) %>% 
  mutate(cesd_geq16 = ifelse(cesd >= 16, 'yes', 'no'),
         nddie_geq16 = ifelse(nddie >= 16, 'yes', 'no'))

rm(migraine)
```


### (a) Summarize the three variables above for epilepsy patients with and without migraine. Carefully choose the descriptive statistics and report both measures of location/spread, sample sizes (N) and number of missing values for each variable. For NDDIE and CSED, use the original scores and the following cutoffs: NDDIE (cutoff of 16), CSED (cutoff of 16). 


Below are point and spread summaries for each of the three variables given. First, for CESD scores, note that the range of possible values is (`r range(migraine_data$cesd, na.rm = T)`).

```{r, echo = FALSE}
migraine_data %>%
  mutate(cesd_binary = recode(cesd_geq16, 'yes' = 1, 'no' = 0)) %>%
  group_by(migraine) %>%
  summarise('Measure' = 'CESD',
            'N' = table(migraine) - summary(cesd)[7],  
            'Mean' = mean(cesd, na.rm = T),  
            '25th %' = quantile(cesd, na.rm = T)[2],
            'Median' = median(cesd, na.rm = T),
            '75th %' = quantile(cesd, na.rm = T)[4],
            'Std Dev' = sd(cesd, na.rm = T),
            'CESD >= 16' = sum(cesd_binary, na.rm = T)/table(migraine),
            'NAs' = summary(cesd)[7]) %>%
  knitr::kable()
```


For the NDDIE score, the range of possible values is (`r range(migraine_data$nddie, na.rm = T)`).

```{r, echo = FALSE}
migraine_data %>%
  mutate(nddie_binary = recode(nddie_geq16, 'yes' = 1, 'no' = 0)) %>%
  group_by(migraine) %>%
  summarise('Measure' = 'NDDIE',
            'N' = table(migraine) - summary(nddie)[7],  # number of subjects per group
            'Mean' = mean(nddie, na.rm = T),  # mean CESD
            '25th %' = quantile(nddie, na.rm = T)[2],
            'Median' = median(nddie, na.rm = T),
            '75th %' = quantile(nddie, na.rm = T)[4],
            'Std Dev' = sd(nddie, na.rm = T),
            'NDDIE >= 16' = sum(nddie_binary, na.rm = T)/table(migraine),
            'NAs' = summary(nddie)[7]) %>%
  knitr::kable()
```

For the ABNAS scores, we have the following descriptive statistics:

```{r, echo = FALSE}
language = 
  migraine_data %>%
  group_by(migraine) %>%
  summarise('Measure' = 'Language',
            'N' = table(migraine),  
            'Mean' = mean(abnas_language, na.rm = T),  
            '25th %' = quantile(abnas_language, na.rm = T)[2],
            'Median' = median(abnas_language, na.rm = T),
            '75th %' = quantile(abnas_language, na.rm = T)[4],
            'Max' = max(abnas_language, na.rm = T),
            'Std Dev' = sd(abnas_language, na.rm = T),
            'NAs' = summary(abnas_language)[7]) 

memory = 
  migraine_data %>%
  group_by(migraine) %>%
  summarise('Measure' = 'Memory',
            'N' = table(migraine),  
            'Mean' = mean(abnas_memory, na.rm = T),  
            '25th %' = quantile(abnas_memory, na.rm = T)[2],
            'Median' = median(abnas_memory, na.rm = T),
            '75th %' = quantile(abnas_memory, na.rm = T)[4],
            'Max' = max(abnas_memory, na.rm = T),
            'Std Dev' = sd(abnas_memory, na.rm = T),
            'NAs' = summary(abnas_memory)[7]) 

bind_rows(language, memory) %>%
  knitr::kable()
```




### (b) Create graphical displays to show the scores distributions for NDDIE, CSED, ABNAS (memory and language) by group (migraine vs no-migraine). Please add your recommendations / comments. (5p)

