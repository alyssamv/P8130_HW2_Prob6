---
title: "Biostat HW2 Prob 6"
author: "Alyssa Vanderbeek"
date: "38 September 2018"
output: pdf_document
---

## Problem 6

### A researcher is conducting a study to examine associations of depression and cognitive performance with migraine symptoms. Use data from the Human Epilepsy Project (HEP) to answer the following questions.

Migraine status 0-no, 1-yes
NDDIE: Neurological Disorder Depression Inventory for Epilepsy
CESD: Center for Epidemiologic Studies Depression Scale
Cognitive evaluation: Aldenkamp-Baker

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
load("~/Desktop/FALL 2018/Biostat I/Homework/Write ups/P8130_HW2_Prob6/migraine.RData")

migraine_data = migraine %>%
  janitor::clean_names() %>%  # brings colnames to lowercase, no white space
  mutate(migraine = recode(migraine, `0` = 'no', `1` = 'yes'))
head(migraine_data)
```

```{r, include = FALSE}
migraine_recode = 
  migraine_data %>% 
  mutate(cesd_geq16 = ifelse(cesd >= 16, 'yes', 'no'),
         nddie_geq16 = ifelse(nddie >= 16, 'yes', 'no'))
```

### (a) Summarize the three variables above for epilepsy patients with and without migraine. Carefully choose the descriptive statistics and report both measures of location/spread, sample sizes (N) and number of missing values for each variable. For NDDIE and CSED, use the original scores and the following cutoffs: NDDIE (cutoff of 16), CSED (cutoff of 16). 


Below are point and spread summaries for each of the three variables given. First, for CESD scores, note that the range of possible values is (`r range(migraine_data$cesd, na.rm = T)`).

```{r, echo = FALSE}
migraine_data %>%
  group_by(migraine) %>%
  summarise('Measure' = 'CESD',
            'N' = table(migraine),  
            'Mean' = mean(cesd, na.rm = T),  
            '25th percentile' = quantile(cesd, na.rm = T)[2],
            'Median' = median(cesd, na.rm = T),
            '75th percentile' = quantile(cesd, na.rm = T)[4],
            'Std Dev' = sd(cesd, na.rm = T)) %>%
  knitr::kable()
```

## NDDIE summary
```{r, echo = FALSE}
migraine_data %>%
  group_by(migraine) %>%
  summarise('Measure' = 'NDDIE',
            'N' = table(migraine),  # number of subjects per group
            'Mean' = mean(nddie, na.rm = T),  # mean CESD
            '25th percentile' = quantile(nddie, na.rm = T)[2],
            'Median' = median(nddie, na.rm = T),
            '75th percentile' = quantile(nddie, na.rm = T)[4],
            'Std Dev' = sd(nddie, na.rm = T)) %>%
  knitr::kable()
```


## summary with binary variable
```{r}
migraine_recode %>%
  mutate(cesd_binary = recode(cesd_geq16, 'yes' = 1, 'no' = 0)) %>%
  group_by(migraine) %>%
  summarise(sum(cesd_binary, na.rm = T)/table(migraine))

prop.table(table(Migraine = migraine_recode$migraine, 
      'CESD >= 16' = migraine_recode$cesd_geq16), margin = 1)
table(Migraine = migraine_recode$migraine, 
      'NNDIE >= 16' = migraine_recode$nddie_geq16)
```

## NDDIE summary
```{r}
migraine_data %>%
  group_by(migraine) %>%
  summarise(n_nddie = table(migraine),  # number of subjects per group
            avg_cesd = mean(nddie, na.rm = T),  # mean CESD
            quartile_25 = quantile(nddie, na.rm = T)[2],
            median = median(nddie, na.rm = T),
            quartile_75 = quantile(nddie, na.rm = T)[4],
            sd = sd(nddie, na.rm = T))
```



Create graphical displays to show the scores distributions for NDDIE, CSED, ABNAS (memory and language) by group (migraine vs no-migraine). Please add your recommendations / comments. (5p)

